package helper

// https://cs.opensource.google/go/x/text/+/master:internal/gen/bitfield/bitfield.go
// https://github.com/HewlettPackard/structex

var maskMap = map[int]uint64{
	1:  0b00000000000000001,
	2:  0b00000000000000011,
	3:  0b00000000000000111,
	4:  0b00000000000001111,
	5:  0b00000000000011111,
	6:  0b00000000000111111,
	7:  0b00000000001111111,
	8:  0b00000000011111111,
	9:  0b00000000111111111,
	10: 0b00000001111111111,
	11: 0b00000011111111111,
	12: 0b00000111111111111,
	13: 0b00001111111111111,
	14: 0b00011111111111111,
	15: 0b00111111111111111,
	16: 0b01111111111111111,
	17: 0b000011111111111111111,
	18: 0b000111111111111111111,
	19: 0b001111111111111111111,
	20: 0b011111111111111111111,
}

func Extract(v uint64, start, len int) uint64 {
	r := ((v >> start) & maskMap[len])
	return r
}
